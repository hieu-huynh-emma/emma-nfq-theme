<!-- Remember to include jQuery :) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>

<!-- jQuery Modal -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css"/>

<div id="geolocation-popup" class="modal">
    <p>Thanks for clicking. That felt good.</p>
    <a href="#" rel="modal:close">Close</a>
</div>

<script>

    function checkGeolocation() {
        const COUNTRY_NAME = "Canada"

        fetch('https://api.ipgeolocation.io/ipgeo?apiKey=760c76c456b645fd81eadecde19808ce')
            .then(res => res.json())
            .then(ipgeo => {
                console.log(ipgeo);

                const popupShowed = !!sessionStorage.getItem('geolocationPopupShowed')

                if (!popupShowed && ipgeo.country_name !== COUNTRY_NAME) {
                    showPopup()
                }
            })
    }

    function showPopup() {
        $("#geolocation-popup").modal({
            fadeDuration: 100
        });

        sessionStorage.setItem('geolocationPopupShowed', true);
    }

    checkGeolocation()
</script>
